#### 0.拼命的企鹅

一只企鹅在爬山，每隔一段路都会遇到一块石头。

* 第 1 块石头重量是 a；
* 每往上走一段路，石头重量就会变成上一段的平方。
企鹅可以选择把某些石头捡起来，最后把捡到的石头重量相乘。

问：它怎样捡石头，才能得到重量乘积恰好是 a 的 b 次方的石头？
（比如 b=173 时，要捡哪些石头？）

------

| **出题人** | **王柯**   |
| ---------- | ------------ |
| 知识点1    | 十进制数据与二进制数据的转换 |
| 知识点2    | 数学推理能力 |
| 知识点3    | 快速幂算法思想（阉割版） |

------

```
Ans：
1. 理解石头重量变化规律
    第 1 块石头：重量 = a^1
    第 2 块石头：重量 = a^2
    第 3 块石头：重量 = a^4
    第 4 块石头：重量 = a^8
    第 5 块石头：重量 = a^16
    第 6 块石头：重量 = a^32
    第 7 块石头：重量 = a^64
    第 8 块石头：重量 = a^128

    …依此类推，第 n 块石头重量就是 a^(2^(n-1))。
    也就是说，石头编号和指数的二进制位一一对应。

2. 将 b = 173 转换为二进制

    173 的二进制表示是：(10101101)₂
    对应位权展开：173 = 128 + 32 + 8 + 4 + 1

3. 对应要捡的石头编号
样例分析：
    173 = (10101101)₂
    从右向左数（从低位向高位数），需要捡第1、3、4、6、8段的石头。

题解：
    假设捡了第x、y、z个石头，则最终重量乘积为a^[2^(x-1)] * a^[2^(y-1)] * a^[2^(z-1)] = a^[2^(x-1)+2^(y-1)+2^(z-1)]。
    要使最终重量乘积为a^b
    即使 a^[2^(x-1)+2^(y-1)+2^(z-1)] = a^b
    即使 2^(x-1)+2^(y-1)+2^(z-1) = b
    观察得等式左端都等效于某二进制位表达，第x个石头就对应二进制位从低到高的第x位
    综上所述，只需要算出b的二进制位，找出从低到高的'1'位，每一个'1'其实就是需要捡的石头。
```

Tip:反过来想，想求a^b%p这个值（b可能很大），就可以将b划分到二进制位，每一位对应 a 的幂；遍历 b 的每一位，如果为'1'就把当前幂乘入结果，并对 p 取模，同时每次将幂平方以准备下一位，最终累乘得到 a^b % p。这就是快速幂的基本思想。